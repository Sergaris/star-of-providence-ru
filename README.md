# Star of Providence — Русская локализация

Неофициальный русский перевод для [Star of Providence](https://store.steampowered.com/app/603960/Star_of_Providence/).

Перевод работает через замену слота китайского языка (ZHS) на русский.

## Установка

### Вариант 1: Батник (рекомендуется)

1. Запустите `install_patch.bat`
2. Укажите путь к папке игры (ПКМ по игре в Steam → Управление → Обзор локальных файлов)
3. Нажмите Enter — скрипт создаст бэкап и установит перевод
4. В игре выберите язык **«русский»**

### Вариант 2: Ручная установка

1. Скопируйте все файлы из `localization/` в `<папка игры>/localization/` с заменой
2. Скопируйте `fonts/NotoSans-ExtraBold.ttf` в `<папка игры>/fonts/Chusung-220206.ttf` (переименуйте!)
3. В игре выберите язык **«русский»**

> Для ручного восстановления сохраните оригинальные файлы перед заменой.

### Восстановление оригинала

Запустите `restore_backup.bat` и укажите путь к игре. Бэкап создаётся автоматически при установке через батник.

## Структура проекта

```
star-of-providence-ru/
├── localization/          # CSV-файлы с переводом (готовы к копированию в игру)
├── fonts/                 # Кириллический шрифт (NotoSans-ExtraBold.ttf)
├── scripts/
│   └── patch.py           # Утилита: инициализация, статистика, валидация
├── install_patch.bat      # Автоустановка с бэкапом
├── restore_backup.bat     # Восстановление оригинала
└──  TRANSLATION_PROMPT.md  # Промпт для AI-перевода
```

## Прогресс перевода

Запустите `python scripts/patch.py stats` для актуальной статистики.

| Категория | Файлов | Статус |
|-----------|--------|--------|
| Меню и настройки | 4 | ✓ Готово |
| Оружие, боссы, зоны | 6 | ✓ Готово |
| Описания предметов | 14 | В работе |
| UI и информация | 19 | В работе |
| Бестиарий и смерти | 4 | В работе |
| Диалоги NPC | 5 | В работе |

## Как помочь с переводом

Перевод ведётся с помощью AI-агентов. Каждый CSV-файл переводится независимо.

### Для AI-агентов

1. Прочитайте `TRANSLATION_PROMPT.md` — там полное руководство по стилю и формату
2. Откройте файл из `localization/` (по приоритету из промпта)
3. Найдите строки где `ZHS == EN` (непереведённые)
4. Замените ZHS на русский перевод
5. Проверьте: `python scripts/patch.py validate`

### Для людей

1. Откройте любой CSV из `localization/` в текстовом редакторе
2. Найдите 8-ю колонку (ZHS) — это русский перевод
3. Замените английский текст на русский
4. Отправьте Pull Request

## Утилита patch.py

```bash
# Инициализация localization/ из файлов игры (первый запуск)
python scripts/patch.py init --game-path "E:\SteamLibrary\steamapps\common\Star of Providence"

# Повторная инициализация (перезапись)
python scripts/patch.py init --game-path "..." --force

# Статистика перевода
python scripts/patch.py stats

# Проверка переводов на ошибки
python scripts/patch.py validate
```

## Шрифт

Для отображения кириллицы нужен шрифт `NotoSans-ExtraBold.ttf`. Поместите его в папку `fonts/`:

1. Скачайте [Noto Sans](https://fonts.google.com/noto/specimen/Noto+Sans) (вариант ExtraBold)
2. Переименуйте в `NotoSans-ExtraBold.ttf`
3. Положите в `fonts/` в корне репозитория

Без шрифта перевод будет работать, но часть символов может не отображаться.

## Технические детали

- Переводы хранятся в колонке `ZHS` (заменяет китайский язык)
- Формат: CSV, UTF-8 BOM (`utf-8-sig`)
- Шрифт `Chusung-220206.ttf` (корейский) заменяется на `NotoSans-ExtraBold.ttf` (кириллица)
- Спецсимволы в тексте: `#` (перенос), `/c0-5` (цвета), `/f0-1` (формат), `/p1-2` (пауза), `%var%` (переменные)

## При обновлении игры

Если игра обновилась и появились новые строки:

1. `python scripts/patch.py init --game-path "..." --force` — обновит localization/
2. Проверьте `git diff` — новые строки будут иметь ZHS == EN
3. Переведите новые строки
